deps=()
pkgname=readline
pkgver=6.3
src="http://ftp.gnu.org/gnu/readline/readline-6.3.tar.gz"
patchsrc="http://www.linuxfromscratch.org/patches/lfs/7.9-rc1/readline-6.3-upstream_fixes-3.patch"
website="http://cnswww.cns.cwru.edu/php/chet/readline/rltop.html"
diskusage="13.5 MB"
buildtime="0.1 SBU"
function pkgfetch {
    if [ ! -f "/usr/src/"$(basename $src) ]; then
        wget $src -O /usr/src/$(basename $src)
    fi
    if [ -f "/usr/src/"$(basename $patchsrc) ]; then
        wget $patchsrc -O /usr/src/$(basename $patchsrc)
    fi
    cp /usr/src/$(basename $patchsrc) $pkgdir
    tar -xf /usr/src/$(basename $src) -C $pkgdir
    }

function pkgmake {
cd $pkgdir/$pkgname-$pkgver
patch -Np1 -i ../readline-6.3-upstream_fixes-3.patch
sed -i '/MV.*old/d' Makefile.in
sed -i '/{OLDSUFF}/c:' support/shlib-install
./configure --prefix=/usr --disable-static --docdir=/usr/share/doc/readline-6.3
make SHLIB_LIBS=-lncurses
}

function pkginstall {
mkdir -pv /lib
make DESTDIR=$installdir SHLIB_LIBS=-lncurses install
mv -v $installdir/usr/lib/lib{readline,history}.so.* $installdir/lib
ln -sfv $installdir/lib/$(readlink $installdir/usr/lib/libreadline.so) $installdir/usr/lib/libreadline.so
ln -sfv $installdir/lib/$(readlink $installdir/usr/lib/libhistory.so ) $installdir/usr/lib/libhistory.so
install -v -m644 doc/*.{ps,pdf,html,dvi} $installdir/usr/share/doc/readline-6.3
}

function pkgafterinstall {
cd $installdir
}
